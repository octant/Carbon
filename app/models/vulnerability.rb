class Vulnerability < ActiveRecord::Base
  has_and_belongs_to_many :personalities
  has_many :locations, :through => :personalities
  
  validates :qid, :uniqueness => true
  
  default_scope :order => 'severity DESC'
  scope :high_priority, where("severity >= ? AND fixable = ?", '4', true)
  scope :low_priority, where("severity < ? AND fixable = ?", '4', true)
  scope :unfixable, where("fixable = ?", false)
  
  def name
    qid
  end
  
end
